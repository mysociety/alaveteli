<% @title = 'Debug' %>

<h1><%= @title %></h1>

<p>You are <%= @admin_current_user %></p>

<h2>Version numbers</h2>

<table class="table table-condensed table-debug">
  <tr>
    <td>Alaveteli version:</td>
    <td><%= @current_version %></td>
  </tr>

  <tr>
    <td>Alaveteli Branch:</td>

    <% if @current_branch == '(no branch)' %>
      <td>(no branch)</td>
    <% else %>
      <td><%= link_to @current_branch, @github_origin + @current_branch %></td>
    <% end %>
  </tr>

  <tr>
    <td>Alaveteli commit:</td>
    <td><%= link_to @current_commit, @github_origin + @current_commit %></td>
  </tr>

  <tr>
    <td>RUBY_VERSION</td>
    <td><%= RUBY_VERSION %></td>
  </tr>

  <tr>
    <td>Rails::VERSION::STRING</td>
    <td><%= Rails::VERSION::STRING %></td>
  </tr>

  <tr>
    <td>Xapian::version_string</td>
    <td><<%= Xapian::version_string %></td>
  </tr>
</table>

<h2>Configuration</h2>

<div class="help-block">
  <p>
    See the <a href="https://alaveteli.org/docs/customising/config/">
    documentation</a> for more information about configuring Alaveteli.
  </p>

  <p>
    Sensitive values are replaced with <tt>[FILTERED]</tt>. Use the
    <tt>config/general.yml</tt> configuration file to view these.
  </p>
</div>

<table class="table table-condensed table-debug">
  <tr>
    <td>Rails env:</td>
    <td><%= Rails.env %></td>
  </tr>
  <tr>
    <td>Rails root:</td>
    <td><%= Rails.root %></td>
  </tr>
</table>

<table class="table table-condensed table-debug">
  <% @alaveteli_configuration.each do |k,v| %>
    <tr>
      <td><%= k %></td>
      <td><%= v %></td>
    </tr>
  <% end %>
</table>

<h2>Environment variables</h2>

<table class="table table-condensed table-debug">
  <% @request_env.each do |k,v| %>
    <tr>
      <td><%= k %></td>
      <td><%= v %></td>
    </tr>
  <% end %>
</table>

<h2>Parameters</h2>

<table class="table table-condensed table-debug">
  <% params.each do |k,v| %>
    <tr>
      <td><%= k %></td>
      <td><%= v %></td>
    </tr>
  <% end %>
</table>

<h2>Session</h2>

<table class="table table-condensed table-debug">
  <% session.to_hash.each do |k,v| %>
    <tr>
      <td><%= k %></td>
      <td><%= v %></td>
    </tr>
  <% end %>
</table>
